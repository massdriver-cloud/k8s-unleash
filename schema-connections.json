{"$id":"https://schemas.massdriver.cloud/schemas/bundles/k8s-unleash/schema-connections.json","$schema":"http://json-schema.org/draft-07/schema","description":"Unleash is a open source feature flag \u0026 toggle system, that gives you a great overview over all feature toggles across all your applications and services. It comes with official client implementations for Java, Node.js, Go, Ruby, Python and .NET Core.","name":"k8s-unleash","properties":{"kubernetes_cluster":{"$id":"https://api.massdriver.cloud/artifact-definitions/massdriver/kubernetes-cluster.json","$md":{"access":"public","defaultTargetConnectionGroup":"credentials","defaultTargetConnectionGroupLabel":"Kubernetes"},"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"Kubernetes cluster authentication and cloud-specific configuration.","properties":{"data":{"additionalProperties":false,"properties":{"authentication":{"additionalProperties":false,"properties":{"cluster":{"additionalProperties":false,"properties":{"certificate-authority-data":{"type":"string"},"server":{"type":"string"}},"required":["server","certificate-authority-data"],"type":"object"},"user":{"additionalProperties":false,"properties":{"token":{"type":"string"}},"required":["token"],"type":"object"}},"required":["cluster","user"],"type":"object"},"infrastructure":{"additionalProperties":true,"description":"Cloud specific Kubernetes configuration data.","oneOf":[{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"","properties":{"arn":{"$schema":"http://json-schema.org/draft-07/schema","description":"Amazon Resource Name","examples":["arn:aws:rds::ACCOUNT_NUMBER:db/prod","arn:aws:ec2::ACCOUNT_NUMBER:vpc/vpc-foo"],"message":{"pattern":"Correct format of an arn described here: https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html"},"pattern":"^arn:aws:[a-zA-Z0-9._-]*:[a-zA-Z0-9._-]*:[0-9]{12}:[a-zA-Z0-9._-]+(?:[/:][a-zA-Z0-9/._-]+)?$","title":"AWS ARN","type":"string"},"oidc_issuer_url":{"$schema":"http://json-schema.org/draft-07/schema","description":"An HTTPS endpoint URL","examples":["https://example.com/some/path","https://massdriver.cloud"],"pattern":"^https://","title":"HTTPS URL","type":"string"}},"required":["arn","oidc_issuer_url"],"title":"AWS EKS infrastructure config","type":"object"},{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"","properties":{"ari":{"$schema":"http://json-schema.org/draft-07/schema","description":"Azure Resource ID","examples":["/subscriptions/12345678-1234-1234-abcd-1234567890ab/resourceGroups/resource-group-name/providers/Microsoft.Network/virtualNetworks/network-name"],"message":{"pattern":"Must be a valid Azure Resource ID"},"pattern":"^/subscriptions/[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/resourceGroups/[a-zA-Z0-9-_.()]{0,89}[a-zA-Z0-9-_()]/providers/Microsoft\\.[a-zA-Z]+/[a-zA-Z]+/[0-9A-Za-z-]+$","title":"Azure Resource ID","type":"string"}},"required":["ari"],"title":"Azure AKS infrastructure config","type":"object"},{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"","properties":{"grn":{"$schema":"http://json-schema.org/draft-07/schema","description":"GCP Resource Name (GRN)","examples":["projects/my-project/global/networks/my-global-network","projects/my-project/regions/us-west2/subnetworks/my-subnetwork","projects/my-project/topics/my-pubsub-topic","projects/my-project/subscriptions/my-pubsub-subscription","projects/my-project/locations/us-west2/instances/my-redis-instance","projects/my-project/locations/us-west2/clusters/my-gke-cluster"],"message":{"pattern":"The provided GRN does not follow the expected pattern. See the examples for valid GRNs."},"pattern":"^projects/[a-z0-9-]+/[a-z]+/[a-z0-9-]+(?:/[a-zA-Z0-9-_.]+){0,6}$","title":"GCP Resource Name (GRN)","type":"string"}},"required":["grn"],"title":"GCP GKE infrastructure config","type":"object"}],"title":"Cloud provider configuration","type":"object"}},"required":["authentication"],"type":"object"},"specs":{"additionalProperties":false,"properties":{"kubernetes":{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"Kubernetes distribution and version specifications.","properties":{"cloud":{"enum":["aws","gcp","azure"],"type":"string"},"distribution":{"enum":["eks","gke","aks"],"type":"string"},"platform_version":{"type":"string"},"version":{"type":"string"}},"required":["version","cloud","distribution"],"title":"Kubernetes","type":"object"}},"type":"object"}},"required":["data"],"title":"Kubernetes Cluster","type":"object"},"postgresql_authentication":{"$id":"https://api.massdriver.cloud/artifact-definitions/massdriver/postgresql-authentication.json","$md":{"access":"public","importing":{"group":"data"}},"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"Authentication parameters for a PostgreSQL database","properties":{"data":{"additionalProperties":false,"properties":{"authentication":{"additionalProperties":false,"properties":{"hostname":{"type":"string"},"password":{"type":"string"},"port":{"$schema":"http://json-schema.org/draft-07/schema","description":"Port number","maximum":65535,"minimum":0,"title":"Port","type":"integer"},"username":{"type":"string"}},"required":["username","password","hostname","port"],"title":"Authentication details","type":"object"},"infrastructure":{"additionalProperties":true,"description":"Cloud specific PostgreSQL configuration data.","oneOf":[{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"","properties":{"arn":{"$schema":"http://json-schema.org/draft-07/schema","description":"Amazon Resource Name","examples":["arn:aws:rds::ACCOUNT_NUMBER:db/prod","arn:aws:ec2::ACCOUNT_NUMBER:vpc/vpc-foo"],"message":{"pattern":"Correct format of an arn described here: https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html"},"pattern":"^arn:aws:[a-zA-Z0-9._-]*:[a-zA-Z0-9._-]*:[0-9]{12}:[a-zA-Z0-9._-]+(?:[/:][a-zA-Z0-9/._-]+)?$","title":"AWS ARN","type":"string"}},"required":["arn"],"title":"AWS RDS infrastructure config","type":"object"},{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"","properties":{"name":{"$schema":"http://json-schema.org/draft-07/schema","description":"Name of CloudSQL Instance","examples":["my-cloud-function","my-sql-instance"],"maxLength":63,"message":{"pattern":"Name must be lowercase alphanumeric (a-z and 0-9) with dashes (-) between words. It must start with a letter and it must end with a letter or number."},"minLength":1,"pattern":"^[a-z]+[-a-z0-9]+[a-z0-9]+$","title":"Name","type":"string"}},"required":["name"],"title":"GCP infrastructure config","type":"object"},{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"","properties":{"ari":{"$schema":"http://json-schema.org/draft-07/schema","description":"Azure Resource ID","examples":["/subscriptions/12345678-1234-1234-abcd-1234567890ab/resourceGroups/resource-group-name/providers/Microsoft.Network/virtualNetworks/network-name"],"message":{"pattern":"Must be a valid Azure Resource ID"},"pattern":"^/subscriptions/[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/resourceGroups/[a-zA-Z0-9-_.()]{0,89}[a-zA-Z0-9-_()]/providers/Microsoft\\.[a-zA-Z]+/[a-zA-Z]+/[0-9A-Za-z-]+$","title":"Azure Resource ID","type":"string"}},"required":["ari"],"title":"Azure Database","type":"object"}],"title":"Cloud provider details","type":"object"},"security":{"additionalProperties":true,"anyOf":[{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"Informs downstream services of ports to open for communication","properties":{"groups":{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"AWS security group rules to inform downstream services of ports to open for communication","patternProperties":{"^[a-z-]+$":{"properties":{"arn":{"$schema":"http://json-schema.org/draft-07/schema","description":"Amazon Resource Name","examples":["arn:aws:rds::ACCOUNT_NUMBER:db/prod","arn:aws:ec2::ACCOUNT_NUMBER:vpc/vpc-foo"],"message":{"pattern":"Correct format of an arn described here: https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html"},"pattern":"^arn:aws:[a-zA-Z0-9._-]*:[a-zA-Z0-9._-]*:[0-9]{12}:[a-zA-Z0-9._-]+(?:[/:][a-zA-Z0-9/._-]+)?$","title":"Security Group ARN","type":"string"},"port":{"$schema":"http://json-schema.org/draft-07/schema","description":"Port number","maximum":65535,"minimum":0,"title":"Network Port","type":"integer"},"protocol":{"enum":["tcp","udp"],"title":"Network Protocol","type":"string"}},"required":["arn","port","protocol"],"type":"object"}},"title":"AWS Security Group","type":"object"},"iam":{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"IAM Policies","patternProperties":{"^[a-z/]+$":{"properties":{"policy_arn":{"$schema":"http://json-schema.org/draft-07/schema","description":"AWS IAM policy ARN","examples":["arn:aws:rds::ACCOUNT_NUMBER:db/prod","arn:aws:ec2::ACCOUNT_NUMBER:vpc/vpc-foo"],"message":{"pattern":"Correct format of an arn described here: https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html"},"pattern":"^arn:aws:[a-zA-Z0-9._-]*:[a-zA-Z0-9._-]*:[0-9]{12}:[a-zA-Z0-9._-]+(?:[/:][a-zA-Z0-9/._-]+)?$","title":"Policy ARN","type":"string"}},"required":["policy_arn"],"type":"object"}},"title":"IAM","type":"object"}},"required":[],"title":"AWS Security information","type":"object"},{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"Azure Security Configuration","properties":{"iam":{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"IAM Roles And Scopes","patternProperties":{"^[a-z/]+$":{"properties":{"role":{"description":"Azure Role","examples":["Storage Blob Data Reader"],"message":{"pattern":"Must be a valid Azure Role (uppercase, lowercase letters and spaces)"},"pattern":"^[a-zA-Z ]+$","title":"Role"},"scope":{"description":"Azure IAM Scope","title":"Scope","type":"string"}},"required":["role","scope"],"type":"object"}},"title":"IAM","type":"object"}},"required":[],"title":"Security","type":"object"},{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"GCP Security Configuration","properties":{"additionalProperties":false,"iam":{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"IAM Roles And Conditions","patternProperties":{"^[a-z/]+$":{"properties":{"condition":{"description":"GCP IAM Condition","title":"Condition","type":"string"},"role":{"description":"GCP Role","examples":["roles/owner","roles/redis.editor","roles/storage.objectCreator","roles/storage.legacyObjectReader"],"message":{"pattern":"Must be a valid GCP Role, e.g. roles/..."},"pattern":"^roles/[a-zA-Z\\.]+$","title":"Role"}},"required":["role"],"type":"object"}},"title":"IAM","type":"object"}},"required":[],"title":"Security","type":"object"}],"description":"TBD","title":"Security details","type":"object"}},"required":["infrastructure","authentication","security"],"type":"object"},"specs":{"additionalProperties":false,"properties":{"rdbms":{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"description":"Common metadata for relational databases.","examples":[{"engine":"postgresql","engine_version":"10.14","version":"10.14"},{"engine":"mysql","engine_version":"5.7.mysql_aurora.2.03.2","version":"5.7"}],"properties":{"engine":{"$id":"#/properties/engine","description":"The type of database server.","examples":["postgresql","mysql"],"title":"Engine","type":"string"},"engine_version":{"$id":"#/properties/version","description":"The cloud provider's database version.","examples":["5.7.mysql_aurora.2.03.2"],"title":"Engine Version","type":"string"},"version":{"$id":"#/properties/version","default":"","description":"The database version.","examples":["12.2","5.7"],"title":"Version","type":"string"}},"required":["engine","version"],"title":"Relational database specs","type":"object"}},"required":["rdbms"],"type":"object"}},"required":["data","specs"],"title":"PostgreSQL Authentication","type":"object"}},"required":["kubernetes_cluster","postgresql_authentication"]}